{"name":"Change Token Style","type":"script","author":"Ay9FvfAr81B6bMEP","img":"modules/battlezoo-bestiary-pf2e/art/token_button_macro.png","scope":"global","command":"async function getJSON(path){\n  const response = await fetch(path);\n  const json = await response.json();\n  return json;\n}\n\nasync function mapTokens(mode){\n    let filepath = `modules/battlezoo-bestiary-pf2e/scripts/${mode}_art.json`;\n    let actors = await getJSON(filepath);\n    const updates = actors.map(a => ({_id: a.id, token: { img: a.data.token.img,}}));\n    ui.notifications.info(\"Changing art...\")\n    let gamePack = 'battlezoo-bestiary-pf2e.pf2e-battlezoo-bestiary'\n    try {\n        const pack = game.packs.get(gamePack);\n        pack.configure({locked: false})\n        const docs = await pack.getDocuments();\n        const updated = await Actor.updateDocuments(updates, {pack: gamePack});\n        pack.configure({locked: true});\n        ui.notifications.info(`Art changed to ${mode}`)\n        } catch (error) {\n        console.error(`Could not load data for ${gamePack}. That pack may not exist in this world or it may be damaged.`)\n    }\n}\n\nconst dialog = new Dialog({\n    title: 'Select token style',\n    buttons: {\n        full: {\n            icon: '<img src=\"modules/battlezoo-bestiary-pf2e/art/blood_mouse.webp\" width=\"150\" height=\"150\" style=\"border:0px\">', label: 'Original Art', \n            callback: () => mapTokens('full'),\n        },\n        token: {\n            icon: '<img src=\"modules/battlezoo-bestiary-pf2e/art/Tokens/blood_mouse_token.webp\" width=\"150\" height=\"150\" style=\"border:0px\">', label: 'Monster Pog',\n            callback: () => mapTokens('token'),\n        },\n    },\n    default: 'token',\n});\n\ndialog.render(true);","folder":null,"sort":0,"permission":{"default":0,"Ay9FvfAr81B6bMEP":3},"flags":{"core":{"sourceId":"Macro.37lQd3apyw6gphij"}},"_id":"uQ3DcCuylPBkJsfZ"}
